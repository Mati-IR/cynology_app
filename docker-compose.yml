version: '3.8'

services:
  ftp-server:
    image: fauria/vsftpd
    container_name: my-ftp-server
    ports:
      - "20:20"
      - "21:21"
      - "21100-21110:21100-21110"
    volumes:
      - /ścieżka/do/lokalnego/katalogu:/home/vsftpd/user
    environment:
      - FTP_USER=user
      - FTP_PASS=password
    restart: always

  parking_db:
    container_name: parking_db
    restart: always
    platform: linux/x86_64
    build: ./database/parking_db
    volumes:
      - ./database/parking_db/scripts:/docker-entrypoint-initdb.d
      - ./database/parking_db/conf.d:/etc/mysql/conf.d
    ports:
      - "3307:3306"
    env_file:
      - ./database/parking_db/local.env
    # pseudo terminal
    tty: true

  phpmyadmin:
    image: phpmyadmin:latest
    restart: always
    ports:
      - '8077:80'
    environment:
      - PMA_ARBITRARY=1
      - PMA_HOSTS=users_db,listings_db

  backend_app:
    build: ./backend/API_gateway
    ports:
      - "8000:8000"
    depends_on:
      - users_db

